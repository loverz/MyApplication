# 文件系统

可以简单认为 文件系统就是分区。

### 硬盘结构

从存储介质来看，可以分为机械硬盘和固态硬盘。

**很多人认为格式化的目的就是清空数据，其实格式化是为了写入文件系统（就是在硬盘中打入隔断并贴上标签）。**

Linux中默认文件系统为 ext4 （inode块+data数据块+**超级块**）

* super block 超级块 用来存放记录整个文件系统信息，包括block与inode总量、已使用、未使用、文件挂载时间、最后写入时间、最后磁盘检验时间等。
* data block 数据块 实际数据存储位置。
* inode 用来记录文件的权限（r、w、x）、文件的所有者和属组、文件的大小、文件的状态改变时间（ctime）、文件的最近一次读取时间（atime）、文件的最近一次修改时间（mtime）、文件的数据真正保存的 block 编号。每个文件需要占用一个 inode。

### df 命令

文件系统查看命令，通过 df 命令可以査看已经挂载的文件系统的信息包括设备文件名、文件系统总大小、已经使用的大小、剩余大小、使用率和挂载点等。

### du命令

统计目录或文件所占磁盘空间大小的命令

- -a：显示每个子文件的磁盘占用量。默认只统计子目录的磁盘占用量
- -h：使用习惯单位显示磁盘占用量，如 KB、MB 或 GB 等；
- -s：统计总磁盘占用量，而不列出子目录和子文件的磁盘占用量

##### df 与 du命令区别

有时我们会发现，使用 du 命令和 df 命令去统计分区的使用情况时，得到的数据是不一样的。那是因为df命令是从文件系统的角度考虑的，通过文件系统中未分配的空间来确定文件系统中已经分配的空间大小。也就是说，在使用 df 命令统计分区时，不仅要考虑文件占用的空间，还要统计被命令或程序占用的空间（最常见的就是文件已经删除，但是程序并没有释放空间）。

而 du 命令是面向文件的，只会计算文件或目录占用的磁盘空间。也就是说，df 命令统计的分区更准确，是真正的空闲空间。

### mount umount命令

mount挂载linux系统外的文件 umount 卸载

挂载是指将硬盘分区（文件系统）和挂载点（已经建立的空目录）连接起来的过程



### fsck命令

检测和修复文件系统

- -t 文件系统：指定分区的文件系统；
- -A：按照配置文件 /etc/fstab 检查所有分区；
- -a：不用显示用户提示，自动修复文件系统；
- -C：显示检查分区的进度条；
- -f：强制检测。一般 fsck 命令如果没有发现分区有问题，则是不会检测的。如果强制检测，那么不管是否发现问题，都会检测；
- -y：自动修复。和 -a 作用一致，不过有些文件系统只支持 -y；

### dumpe2fs 命令

显示磁盘状态

###  fdisk命令

给硬盘分区，在[Linux](http://c.biancheng.net/linux_tutorial/)中有专门的分区命令 fdisk 和 parted。其中 fdisk 命令较为常用，但不支持大于 2TB 的分区；如果需要支持大于 2TB 的分区，则需要使用 parted 命令，当然 parted 命令也能分配较小的分区。我们先来看看如何使用 fdisk 命令进行分区。

可以配置 /etc/fstab 来配置开机自动挂载的硬盘分区。

### mkfs 命令

格式化分区，给分区写入文件系统的命令。

### swap分区

内存不够时候，会使用swap分区来存放数据。大小一般是内存两倍，但不超过2G

